# Export Module

## Описание
Модуль `Export` отвечает за скачивание экспортированных данных (CSV файлов с результатами тестирования).

## Основные возможности
-   **Скачивание экспорта**: Получение файла экспорта по его ID.

## Доменные сущности
-   **Export**: Сущность экспортированного файла, содержащая данные и метаинформацию.

## API
Основные контроллеры:
-   `ExportController` (`/api/v1/export`):
    -   `GET /:id`: Скачать файл экспорта.

## Архитектура и реализация

### Основные компоненты
-   **ExportService**: Сервис уровня приложения.
    -   `get`: Получает файл экспорта из репозитория и удаляет его после скачивания (one-time download).
-   **IExportRepository**: Интерфейс для доступа к хранилищу экспортированных файлов.

### Команды (Commands)
В данном модуле **не используется** паттерн Command.
Логика получения файла реализована в `ExportService`.

## Для новых разработчиков

### Структура модуля
```
export/
├── api/                 # Presentation Layer (контроллеры, DTO)
│   ├── index.ts
│   └── types.ts
├── infrastructure/     # Infrastructure Layer (реализации интерфейсов)
│   ├── export.repository.prisma.ts
│   └── index.ts
├── model/               # Domain Layer (сущности, сервисы, интерфейсы)
│   ├── domain/          # Доменные объекты и интерфейсы
│   │   ├── commands/
│   │   ├── interfaces/
│   │   └── index.ts
│   ├── services/         # Сервисы уровня приложения
│   │   ├── export.service.ts
│   │   ├── index.ts
│   │   └── out.for-events.service.ts
│   └── index.ts
└── index.ts             # Экспорт модуля
```

### Основные потоки данных

1. **Скачивание экспортированного файла**:
   - Контроллер ExportController получает запрос на скачивание файла
   - ExportService получает файл из бд
   - Файл стримится клиенту
   - После скачивания файл удаляется из бд (one-time download)

### Интеграции с другими модулями

- **Events**: Используется для экспорта результатов мероприятий через out.for-events.service.ts

### Важные особенности

- Все экспортированные файлы доступны только один раз (one-time download)
- После скачивания файлы автоматически удаляются из хранилища
- Модуль использует Dependency Injection для подключения зависимостей
- Для работы с базой данных используется Prisma ORM
