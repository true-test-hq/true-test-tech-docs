# Точка входа в приложение (App)

Этот модуль представляет собой точку входа в приложение и содержит основные провайдеры и конфигурации, необходимые для работы всего приложения.

## Основные компоненты

### App.tsx
Основной компонент приложения, который оборачивает всё приложение в необходимые провайдеры:
- `AppErrorBoundary` - Обработчик ошибок приложения
- `BrowserRouter` - Провайдер маршрутизации
- `TranslationBoundary` - Провайдер локализации
- `DeviceTypeContextProvider` - Провайдер определения типа устройства
- `QueryProvider` - Провайдер управления состоянием данных
- `ProgressLoaderProvider` - Провайдер индикатора загрузки

### Роутинг (router/)
Модуль маршрутизации приложения, который определяет все доступные маршруты и их компоненты.

#### Основные особенности:
- Разделение маршрутов на публичные и приватные
- Использование RoleGuard для защиты маршрутов
- Интеграция с WaitAuth для ожидания аутентификации
- Поддержка мобильных заглушек для администраторов

#### Структура маршрутов:
- Публичные маршруты (доступны без аутентификации)
- Приватные маршруты (доступны только авторизованным пользователям)
  - Администраторские маршруты
  - Маршруты участников
  - Внутренние маршруты решателя

### Управление состоянием данных (query/)
Провайдер управления состоянием данных на основе React Query.

#### Основные особенности:
- Централизованное управление состоянием данных
- Автоматическая обработка ошибок запросов
- Интеграция с системой уведомлений
- Интеграция с Sentry для отслеживания ошибок
- Управление индикатором загрузки

#### Конфигурация:
- `mutationCache` - Обработчик мутаций
- `queryCache` - Обработчик запросов
- `queryClient` - Основной клиент для работы с данными

### Индикатор загрузки (progress-loader/)
Провайдер индикатора загрузки, который отображает прогресс выполнения асинхронных операций.

#### Основные особенности:
- Использование Effector для управления состоянием
- Глобальный индикатор загрузки в верхней части экрана
- Автоматическое отображение при начале мутаций
- Автоматическое скрытие при завершении мутаций

### Определение типа устройства (device-type/)
Провайдер определения типа устройства пользователя (мобильное, планшет, десктоп).

#### Основные особенности:
- Автоматическое определение типа устройства
- Установка атрибута data-device-type на body
- Предоставление хука useDeviceType для получения типа устройства

### Локализация (translation/)
Провайдер локализации на основе i18next.

#### Основные особенности:
- Поддержка нескольких языков (ru, en)
- Автоматическое определение языка браузера
- Интеграция с date-fns для локализации дат
- Поддержка ICU форматирования

#### Локализованные ресурсы:
- Русский язык (locale-ru.json)
- Английский язык (locale-en.json)

### Обработчик ошибок (app-error-boundary/)
Глобальный обработчик ошибок приложения.

#### Основные особенности:
- Перехват необработанных ошибок React
- Интеграция с Sentry для отслеживания ошибок
- Отображение дружелюбного сообщения об ошибке
- Возможность перезагрузки приложения

### Константы (constants/)
Глобальные константы приложения.

#### Основные константы:
- `routes` - Все маршруты приложения
- `Char` - Специальные символы
- `MAX_INT_32` - Максимальное 32-битное целое число
- `FEATURE_TOGGLE` - Переключатели функций

## Зависимости

### Внешние библиотеки:
- React и ReactDOM
- React Router для маршрутизации
- React Query для управления состоянием данных
- i18next для локализации
- Effector для управления состоянием индикатора загрузки
- Sentry для мониторинга ошибок
- ismobilejs для определения типа устройства

### Внутренние модули:
- Shared модули (ui, api, utils)
- Pages модули (все страницы приложения)
- Modules модули (бизнес-логика)

## Использование

### Запуск приложения:
1. Основная точка входа: `src/index.tsx`
2. Рендеринг компонента App в DOM элемент с id="root"
3. App оборачивает всё приложение в необходимые провайдеры

### Добавление новых маршрутов:
1. Добавить маршрут в `routes` в `constants/index.ts`
2. Добавить компонент страницы в соответствующую секцию в `router/Router.tsx`
3. Защитить маршрут с помощью RoleGuard при необходимости

### Добавление новых локализованных строк:
1. Добавить строки в соответствующие файлы в `translation/locale/`
2. Использовать хук `useTranslation` или функцию `t` для получения перевода

### Обработка ошибок:
1. Все ошибки компонентов перехватываются AppErrorBoundary
2. Ошибки запросов автоматически отправляются в Sentry
3. Пользователю отображается дружелюбное сообщение об ошибке

## Архитектура

### Принципы:
- Единая точка входа в приложение
- Централизованная конфигурация всех провайдеров
- Четкое разделение ответственности между модулями
- Максимальная переиспользуемость компонентов

### Структура:
- Каждый модуль находится в отдельной директории
- Модули экспортируются через index.ts файлы
- Стили модулей находятся рядом с компонентами
- Типы и интерфейсы определяются в соответствующих файлах

### Интеграция с другими модулями:
- Использование shared компонентов для UI
- Использование pages компонентов для страниц
- Использование modules для бизнес-логики
- Использование shared/api для работы с API